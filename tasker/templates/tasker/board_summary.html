{% extends 'base.html' %}

{% load timedelta %}

{% block title %}{{ board.label }} &middot; {{ block.super }}{% endblock %}

{% block nav %}{% include "navbar/board.html" with board=board active='board_summary' %}{% endblock %}

{% block content %}
 {% if tasks_done_complex %}
  <h5>Done with comments</h5>
  <div class="card-columns">
   {% for task in tasks_done_complex %}
    {% include "task/board_summary.html" with task=task %}
   {% endfor %}
  </div>
 {% endif %}
 {% if tasks_done_simple %}
  <h5>Done without comments</h5>
  <div class="table-responsive">
   <table class="table table-striped">
    <thead class="thead-dark">
     <tr>
      <th scope="col" style="width:100%">Task</th>
      <th scope="col" class="text-nowrap">Done by</th>
      <th scope="col" class="text-nowrap">Duration</th>
     </tr>
    </thead>
    <tbody>
     {% for task, handling in tasks_done_simple %}
      <tr>
       <td><a href="{% url 'show_task' task.board.slug task.id %}">{{ task.label }}</a></td>
       <td class="text-nowrap">{{ handling.editor }}</td>
       <td class="text-nowrap text-right">{{ task.get_total_duration | timedelta }}</td>
      </tr>
     {% endfor %}
    </tbody>
   </table>
  </div>
 {% endif %}
 {% if not tasks_done_complex and not tasks_done_simple %}
  <h5>Done</h5>
  <p class="alert alert-danger">No tasks done</p>
 {% endif %}

 <h5>Open Tasks</h5>
 {% if tasks_not_done %}
  <ul class="list-group">
   {% for task, handlings in tasks_not_done %}
    <li class="list-group-item">
     <a href="{% url 'show_task' task.board.slug task.id %}">{{ task.label }}</a>
     {% if task.is_locked %}
      <span class="badge badge-warning">Locked by {{ task.reserved_by }} for {{ task.reserved_until | timeuntil }}</span>
     {% endif %}
     {% for handling in handlings %}
      <span class="badge badge-primary">Active by {{ handling.editor }} since {{ handling.start | timesince }}</span>
     {% endfor %}
    </li>
   {% endfor %}
  </ul>
 {% else %}
  <p class="alert alert-warning">No tasks open</p>
 {% endif %}
{% endblock %}
